         LCLC  &LABEL,&R1,&R14,&R15
         GBLC  &RCPBFRP,&RCPBFR1,&RCPBFR2,&RCPBFSP
         AIF   ('&BUFPTR' EQ '').BFRTGP
&RCPBFRP SETC  '&BUFPTR'
         AGO   .BFRTWK1
.BFRTGP  AIF   ('&RCPBFRP' NE '').BFRTWK1
&RCPBFRP SETC  'R1'
.BFRTWK1 AIF   ('&WKREGS(1)' EQ '').BFRTG1
&RCPBFR1 SETC  '&WKREGS(1)'
         AGO   .BFRTWK2
.BFRTG1  AIF   ('&RCPBFR1' NE '').BFRTWK2
&RCPBFR1 SETC  'R14'
.BFRTWK2 AIF   ('&WKREGS(2)' EQ '').BFRTG2
&RCPBFR2 SETC  '&WKREGS(2)'
         AGO   .BFRG1
.BFRTG2  AIF   ('&RCPBFR2' NE '').BFRG1
&RCPBFR2 SETC  'R15'
.BFRG1   ANOP
         AIF   ('&SPACE' EQ '').BFRG2
&RCPBFSP SETC  '&SPACE'
.BFRG2   ANOP
&LABEL   SETC  '&NAME'
&R1      SETC  '&RCPBFRP'
&R14     SETC  '&RCPBFR1'
&R15     SETC  '&RCPBFR2'
.BFRTBUF AIF   ('&BUFFER' EQ '').BFRGXIT
         AIF   ('&BUFFER'(1,1) EQ '(').RBUF
&LABEL   LA    &R1,&BUFFER             LOAD BUFFER ADDRESS
&LABEL   SETC  ''
         AGO   .BFRGXIT
.RBUF    ANOP
&LABEL   LR    &R1,&BUFFER(1)          LOAD BUFFER ADDRESS
&LABEL   SETC  ''
.BFRGXIT ANOP
